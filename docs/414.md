# Azure SQL 数据库配置

> 原文:[https://www.javatpoint.com/azure-sql-database-configuration](https://www.javatpoint.com/azure-sql-database-configuration)

我们将在这里看到 Azure SQL Server 和 SQL 数据库的关键配置特性。就 Azure SQL 数据库配置而言，首先关键的是服务器级别的防火墙规则。

## 防火墙规则

在 Azure 中的逻辑服务器上，我们可以定义一些防火墙规则。可以是 IP 规则。IP 规则将根据每个请求的原始 IP 地址授予对数据库的访问权限。第二种规则是虚拟网络规则。它基于虚拟网络服务端点。

Azure SQL 数据库的规则可以在两个级别定义:

*   **服务器级防火墙规则:**这些防火墙规则使客户端能够访问我们的整个 Azure SQL server，即类似逻辑服务器内的每个数据库。这些防火墙规则将存储在主数据库中。服务器级防火墙规则可以通过使用门户或使用 Transact-SQL 语句来配置。
*   **数据库级防火墙规则:**这些规则使客户端能够访问同一逻辑服务器内的某些(安全)数据库。我们可以为每个数据库(包括主数据库)创建这些规则，并将它们存储在各个数据库中。

### 在 Azure 门户中配置防火墙规则

**步骤 1:** 转到您已经创建的数据库服务器中的防火墙设置。之后，点击 ***添加客户端*** 。

![Azure SQL Database Configuration](../Images/e646ab17859e65a921e30c4445be0e7d.png)

**第二步:**现在，点击 ***添加已有虚拟网络*** 并填写所需详细信息，如下图所示。

![Azure SQL Database Configuration](../Images/4a20ac88c1456ddf2b2da34c7110adc7.png)

**第三步:**最后点击保存，你会得到你的防火墙规则更新的通知。

![Azure SQL Database Configuration](../Images/3deb37185ea1187ba2d2383ea3856973.png)

### 地理复制

它是在数据库级别而不是服务器级别定义的，它被设计为一种业务连续性解决方案，允许应用程序在发生区域性灾难或大规模停机时对单个数据库执行快速灾难恢复。

![Azure SQL Database Configuration](../Images/38dc4b0480bd3e5ac7472fed7af5ebe2.png)

当我们配置地理复制时，我们在远离主位置的位置指定一个辅助数据库。我们可以有一个流量管理器，它默认将流量路由到我们的主负载平衡器，并且主负载平衡器基于应用程序请求。如果它是读写的，那么它可以路由到主逻辑服务器。如果它是“只读的”，它可以路由到辅助服务器。因此，地理复制的优势在于，我们可以将一些只读流量从主节点卸载并路由到辅助节点。

主要性能将是好的，因为只读查询将消耗一定数量的 CPU 或安装的 DTU 单元，我们有一个辅助数据库，在那里数据被连续复制。

### 使用 Azure 门户配置地理复制

**步骤 1:** 点击地理复制选项；您将看到以下窗口。

![Azure SQL Database Configuration](../Images/64b918bbc410253aa4478a6cabff6b4e.png)

**步骤 2:** 现在，选择要复制数据库的位置。您可以选择多个位置。

![Azure SQL Database Configuration](../Images/9fa594be1c776c2cd6598d74bc55e201.png)

**步骤 3:** 现在，为要复制数据的位置创建一个 SQL 服务器。

![Azure SQL Database Configuration](../Images/5116e42de17c09f288c084cf23c1cbf4.png)

**步骤 4:** 您的服务器已成功创建和复制。

![Azure SQL Database Configuration](../Images/801fbb26c516765fb9fd6d93760d3fde.png)

**第五步:**可以看到下图，服务器被复制了。

![Azure SQL Database Configuration](../Images/9ab9503a6016c94d4037bf95b3fcf0aa.png)

### 故障转移组

自动故障转移组是 SQL 数据库的一项功能，它允许我们管理逻辑服务器上一组数据库或托管实例中所有数据库到另一个区域的复制和故障转移。

我们可以手动启动故障转移，也可以根据用户定义的策略将其委托给 SQL 数据库服务。当我们使用带有自动故障切换策略的自动故障切换组时，任何影响组中一个或多个数据库的中断都会导致自动故障切换。当数据库在故障转移后发生变化时，它允许读写 SQL 应用程序透明地重新连接到主数据库。

### 数据库备份

SQL 数据库使用 SQL server 技术为时间点还原(PITR)创建完整、差异和事务日志备份。事务日志备份通常每 5-10 分钟进行一次，差异备份通常每 12 小时进行一次，频率取决于计算大小和数据库活动量。每个 SQL 数据库的默认备份保留期在 7 到 35 天之间，具体取决于购买模式和服务级别。

长期备份保留(LTR)利用自动创建的完整数据库备份来实现时间点恢复。如果配置了 LTR 策略，这些备份将被复制到不同的存储区块。我们可以为每个 SQL 数据库设置一个 LTR 策略，并指定将备份复制到长期存储区块的频率。

* * *